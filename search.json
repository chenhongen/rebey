[{"title":"Json的转换与传递","url":"http://yoursite.com/2016/04/16/Json的转换与传递/","content":"<ul>\n<li><p><strong>概要</strong></p>\n<p>  项目中常用的json形式数据在前后台实现string与object对象等各种互转相关知识点整理。</p>\n</li>\n<li><p><strong>前端：Form Data–&gt;Json Object–&gt;Json String:</strong></p>\n</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">☞ jsp片段：</div><div class=\"line\">&lt;form action=<span class=\"string\">\"\"</span> id=<span class=\"string\">\"jsonForm\"</span>&gt;</div><div class=\"line\">    <span class=\"built_in\">cd</span>：&lt;input <span class=\"built_in\">type</span>=<span class=\"string\">\"text\"</span> id=<span class=\"string\">\"\"</span> name=<span class=\"string\">\"goodsCd\"</span> value=<span class=\"string\">\"20150904\"</span> /&gt;&lt;br/&gt;</div><div class=\"line\">    name：&lt;input <span class=\"built_in\">type</span>=<span class=\"string\">\"text\"</span> id=<span class=\"string\">\"\"</span> name=<span class=\"string\">\"goodsName\"</span> value=<span class=\"string\">\"che\"</span>/&gt;</div><div class=\"line\">&lt;/form&gt;</div></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">☞ js片段：</div><div class=\"line\">//具有name、value属性，序列化成一个Object对象</div><div class=\"line\">$.fn.serializeObject = <span class=\"function\"><span class=\"title\">function</span></span>() &#123;</div><div class=\"line\">   var obj = &#123;&#125;;</div><div class=\"line\">   var arr = this.serializeArray();</div><div class=\"line\">   $.each(arr, <span class=\"function\"><span class=\"title\">function</span></span>() &#123;</div><div class=\"line\">       <span class=\"keyword\">if</span> (obj[this.name]) &#123;</div><div class=\"line\">           <span class=\"keyword\">if</span> (!obj[this.name].push) &#123;</div><div class=\"line\">               obj[this.name] = [ obj[this.name] ];</div><div class=\"line\">           &#125;</div><div class=\"line\">           obj[this.name].push(this.value || <span class=\"string\">''</span>);</div><div class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">           obj[this.name] = this.value || <span class=\"string\">''</span>;</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125;);</div><div class=\"line\">   <span class=\"built_in\">return</span> obj;</div><div class=\"line\">&#125;;</div><div class=\"line\">var jsonForm = $(<span class=\"string\">\"#jsonForm\"</span>);</div><div class=\"line\">// json对象转json字符串</div><div class=\"line\">var jsonStr = JSON.stringify(jsonForm.serializeObject());</div><div class=\"line\">alert(jsonStr);</div></pre></td></tr></table></figure>\n<ul>\n<li><strong>前端：Json String–&gt;Json Object：</strong></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">☞ js片段：</div><div class=\"line\">jQuery.parseJSON(jsonStr));</div></pre></td></tr></table></figure>\n<ul>\n<li><strong>前后端：Json Object–&gt;JavaBean：</strong></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">☞ js片段：</div><div class=\"line\">// rb须与后台实体变量名称同名</div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">getRbJson</span></span>()&#123;</div><div class=\"line\">    var rbJson = &#123;&#125;;</div><div class=\"line\">    </div><div class=\"line\">    rbJson[<span class=\"string\">\"rb.goodsType\"</span>] = <span class=\"string\">\"a\"</span>;</div><div class=\"line\">    rbJson[<span class=\"string\">\"rb.goodsCd\"</span>] = <span class=\"string\">\"b\"</span>;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"built_in\">return</span> rbJson;</div><div class=\"line\">&#125;</div><div class=\"line\">$(<span class=\"function\"><span class=\"title\">function</span></span>()&#123;</div><div class=\"line\">    $.ajax(&#123;</div><div class=\"line\">        url: <span class=\"string\">\"setJsonObject.action\"</span>,</div><div class=\"line\">\t<span class=\"built_in\">type</span>: <span class=\"string\">'POST'</span>,</div><div class=\"line\">\tcache: <span class=\"literal\">false</span>,</div><div class=\"line\">\tasync:<span class=\"literal\">false</span>,</div><div class=\"line\">\tdata: getRbJson(),</div><div class=\"line\">            success: <span class=\"keyword\">function</span> (text) &#123;</div><div class=\"line\">\t&#125;,</div><div class=\"line\">\terror: <span class=\"keyword\">function</span> (jqXHR, textStatus, errorThrown) &#123;</div><div class=\"line\">\t    alert(jqXHR.responseText);</div><div class=\"line\">\t&#125;</div><div class=\"line\">    &#125;);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">☞ java片段：</div><div class=\"line\">private RbGoods rb;</div><div class=\"line\">    public RbGoods <span class=\"function\"><span class=\"title\">getRb</span></span>() &#123;</div><div class=\"line\">    <span class=\"built_in\">return</span> rb;</div><div class=\"line\">&#125;</div><div class=\"line\">public void <span class=\"built_in\">set</span>Rb(RbGoods rb) &#123;</div><div class=\"line\">    this.rb = rb;</div><div class=\"line\">&#125;</div><div class=\"line\">public String <span class=\"function\"><span class=\"title\">setJsonObject</span></span>() &#123;</div><div class=\"line\">    System.out.println(rb.getGoodsCd());</div><div class=\"line\">    <span class=\"built_in\">return</span> SUCCESS;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><strong>前后端：Json String–&gt;JavaBean：</strong></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">☞ js片段：</div><div class=\"line\">var rbStr = &#123;&#125;;</div><div class=\"line\">var rbArray = [];</div><div class=\"line\">rbArray.push(&#123;goodsCd:<span class=\"string\">'1'</span>,goodsName:<span class=\"string\">'che'</span>&#125;);</div><div class=\"line\">rbArray.push(&#123;goodsCd:<span class=\"string\">'2'</span>,goodsName:<span class=\"string\">'chen'</span>&#125;);</div><div class=\"line\">rbStr[<span class=\"string\">\"jsonArrayStr\"</span>] = rbArray;</div><div class=\"line\">$.ajax(&#123;</div><div class=\"line\">       url: <span class=\"string\">\"jsonStrToObject.action\"</span>,</div><div class=\"line\">      <span class=\"built_in\">type</span>: <span class=\"string\">'POST'</span>,</div><div class=\"line\">     cache: <span class=\"literal\">false</span>,</div><div class=\"line\">       async:<span class=\"literal\">false</span>,</div><div class=\"line\">       data: &#123;jsonStr:JSON.stringify(rbArray)&#125;,</div><div class=\"line\">    success: <span class=\"keyword\">function</span> (text) &#123;&#125;,</div><div class=\"line\">   error: <span class=\"keyword\">function</span> (jqXHR, textStatus, errorThrown) &#123;</div><div class=\"line\">           alert(jqXHR.responseText);</div><div class=\"line\">       &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div></pre></td><td class=\"code\"><pre><div class=\"line\">☞ java片段：</div><div class=\"line\">private String jsonStr;</div><div class=\"line\"></div><div class=\"line\">public String <span class=\"function\"><span class=\"title\">getJsonStr</span></span>() &#123;</div><div class=\"line\">    <span class=\"built_in\">return</span> jsonStr;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">public void <span class=\"built_in\">set</span>JsonStr(String jsonStr) &#123;</div><div class=\"line\">    this.jsonStr = jsonStr;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">public String <span class=\"function\"><span class=\"title\">jsonStrToObject</span></span>() &#123;</div><div class=\"line\">    // String转JSON</div><div class=\"line\">    JSONArray jsonArray = JSONArray.fromObject(jsonStr);</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">for</span>(int i = 0; i &lt; jsonArray.size(); i++) &#123;</div><div class=\"line\">        // JSON转object对象</div><div class=\"line\">        String JOStr = jsonArray.getString(i);</div><div class=\"line\">        JSONObject JO = JSONObject.fromObject(JOStr);</div><div class=\"line\">        RbGoods goods =(RbGoods)JSONObject.toBean(JO, RbGoods.class);</div><div class=\"line\">        System.out.println(goods.getGoodsCd());</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"built_in\">return</span> SUCCESS;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> newchePoint(obj) &#123;</div><div class=\"line\">    <span class=\"built_in\">return</span> <span class=\"string\">\"&lt;che id=\\\"\"</span>+obj.id+</div><div class=\"line\">    <span class=\"string\">\"\\\" type=\\\"\"</span>+obj.type+<span class=\"string\">\"\\\" value=\\\"\\\"/&gt;\\r\\n\"</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><strong>更新ing…</strong></li>\n</ul>\n"},{"title":"tag","url":"http://yoursite.com/tag/index.html","content":""},{"title":"category","url":"http://yoursite.com/category/index.html","content":""},{"title":"link","url":"http://yoursite.com/link/index.html","content":""},{"title":"about","url":"http://yoursite.com/about/index.html","content":""},{"title":"project","url":"http://yoursite.com/project/index.html","content":""},{"title":"search","url":"http://yoursite.com/search/index.html","content":""}]